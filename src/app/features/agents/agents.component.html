<div class="flex flex-col h-screen bg-gray-50">
  <!-- Fixed Header - 120px height -->
  <header class="fixed top-0 left-0 right-0 bg-white border-b border-gray-200 z-10" style="height: 120px">
    <div class="h-full px-12 flex items-center header-logos">
      <!-- Left: IPA image -->
      <div class="flex items-center">
        <div class="header-logo">
          <img src="/assets/images/agent-store-ipa.png" alt="IPA"
            onerror="this.onerror=null;this.src='/assets/images/IOA.png'" />
        </div>
      </div>

      <!-- Middle: separator + ai-agents-store left-aligned next to separator -->
      <div class="middle flex items-center">
        <div class="separator" aria-hidden="true"></div>
        <div class="header-logo ml-4">
          <!-- Accessible button that navigates to landing page; styled to look like the original image -->
          <!-- title="Home" -->
          <button
            type="button"
            class="logo-btn"
            aria-label="Go to landing page"
            (click)="navigateHome()"
            style="background: none; border: 0; padding: 0; cursor: pointer;"
          >
            <img src="/assets/images/ai-agents-store.png" alt="AI Agents Store"
              onerror="this.onerror=null;this.src='/assets/images/IOA.png'" />
          </button>
        </div>
      </div>

      <!-- Right: IOA image aligned to right -->
      <div class="flex items-center justify-end">
        <div class="header-logo">
          <img src="/assets/images/agent-store-ioa.png" alt="Intuitive Operations & Automation"
            onerror="this.onerror=null;this.src='/assets/images/IOA.png'" />
        </div>
      </div>
    </div>
  </header>

  <!-- Scrollable Content Area (accounts for fixed header - 7.5rem) -->
  <main id="agents-scroll" class="flex-1 overflow-y-auto" style="margin-top: 7.5rem">
    <router-outlet></router-outlet>
    <!-- Store grid & pagination (only when not in detail-mode) -->
    @if (!detailMode()) {
    <!-- your existing agents grid & pager content exactly as-is -->


    <!-- Hero Section -->
    <section class="hero-bg text-white">
      <div class="hero-content text-center relative">
        <h1 class="hero-heading">Your Unified Platform for Intelligent Agents</h1>
        <p class="hero-description">
          From productivity to creativity, find the right agent and get started instantly. Explore,
          choose, and deploy AI agents designed to power every task, all in one place.
        </p>

        <!-- Search pill overlay (positioned at exact XD coords) -->
        <div class="search-pill" role="search">
          <div class="filter-group filter-group-1">
            <label class="filter-label">By Industries</label>
          </div>
          <div class="filter-group filter-group-2">
            <label class="filter-label">By Technology</label>
          </div>

          <!--  (click)="$event.stopPropagation()" -->
          <div class="search-inner">
            <div class="search-white-area">
              <img src="/assets/images/search.png" />

              <input class="search-input" placeholder="Search AI Agents..." [value]="searchText()"
                (input)="onSearchInput($event)" (keydown.escape)="clearSearch()" (keydown.enter)="applyFilters()">

              <button type="button" class="search-clear" [class.hidden]="!searchText()" (click)="clearSearch()"
                aria-label="Clear search">
                ×
              </button>

              <div class="pill-divider"></div>

              <div class="filters-inline">
                <!-- Industry select -->
                <select class="filter-select" [value]="selectedIndustry()" (change)="onIndustryChange($event)">
                  <!-- <option value="">All</option> -->
                  @for (opt of verticalOptions(); track opt._id) {
                  <option [value]="opt.value">{{ opt.label }}</option>
                  }
                </select>
                <!-- </div> -->


                <div class="pill-divider-2"></div>

                <!-- Technology select -->

                <!-- <div class="filter-group filter-group-2"> -->
                <!-- <span class="filter-label">By Technology</span> -->
                <select class="filter-select" [value]="selectedTechnology()" (change)="onTechnologyChange($event)">
                  <!-- <option value="">All</option> -->
                  @for (opt of techOptions(); track opt._id) {
                  <option [value]="opt.value">{{ opt.label }}</option>
                  }
                </select>
                <!-- </div> -->

              </div>
            </div>

            <button class="search-button" (click)="applyFilters()">Search</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Discover Section with heading background -->
    <section class="discover-section">
      <h2 class="discover-heading">Discover Intelligent AI Agents in Our Store</h2>
      <div class="discover-filter">
        <select class="discover-filter-select" [value]="selectedStage()" (change)="onStageChange($event)">
          <!-- <option value="">All</option> -->
          @for (opt of stageOptions(); track opt._id) {
          <option [value]="opt.label">{{ opt.label }}</option>
          }
        </select>
      </div>
    </section>

    <!-- Agents Grid Section -->
    <section class="agents-store">
      <section class="agents-grid" role="list">
        @for (agent of agents(); track agent.id) {
        <article class="agent-card" role="listitem" aria-label="{{ agent.name }} card">
          <!-- Hero image -->
          <figure class="agent-card__media">
            <img [src]="agent.thumbnailUrl || 'assets/images/temp/Mask Group 2.png'"
              [alt]="agent.thumbnailUrl || 'Warehouse aisle with a person holding a tablet'" loading="lazy"
              class="agent-card__img" />
          </figure>

          <!-- Content -->
          <div class="agent-card__content">
            <h2 class="agent-card__title truncate" [title]="agent.name">{{ agent.name }}</h2>

            <p class="agent-card__desc line-clamp-8" [title]="agent.description">
              {{ agent.description }}
            </p>

            <!-- Feature grid -->
            <div class="agent-card__features" role="list">
              <!-- Industry (left) -->
              <div class="agent-card__feature" role="listitem">
                <div class="agent-card__icon" aria-hidden="true">
                  <!-- /assets/images/industry.png -->
                  <img src="/assets/images/industry.png" alt="" />
                </div>
                <div class="agent-card__label">{{ agent.industry || 'Supply Chain' }}</div>
              </div>

              <div class="agent-card__divider" aria-hidden="true"></div>

              <!-- Agent count (center) -->
              <div class="agent-card__feature" role="listitem">
                <div class="agent-card__icon agent-card__icon--pill" aria-hidden="true">
                  <span class="agent-card__pill">{{ agent.agentCount }}</span>
                </div>
                <div class="agent-card__label">Agent count</div>
              </div>

              <div class="agent-card__divider" aria-hidden="true"></div>

              <!-- Technology (right) -->
              <div class="agent-card__feature" role="listitem">
                <div class="agent-card__icon" aria-hidden="true">
                  <!-- /assets/images/technology.png -->
                  <img src="/assets/images/technology.png" alt="" />
                </div>
                <div class="agent-card__label">
                  {{ agent.technology || 'Copilot Studio | UiPath Agentic' }}
                </div>
              </div>
            </div>
          </div>

          <!-- Accent underline -->
          <div class="agent-card__accent"></div>

          <!-- Footer -->
          <div class="agent-card__footer">
            <div class="agent-card__stage">
              <span class="agent-card__stage-icon">
                <img src="/assets/images/tag.png" alt="Stage" />
              </span>
              <span class="agent-card__stage-label">Stage:</span>
              <span class="agent-card__stage-value">{{ agent.stage }}</span>
            </div>

            <!-- CTA (button; swap to routerLink if you have a details route) -->
            <button class="agent-card__cta" type="button" (click)="openAgent(agent.id)"
              aria-label="Explore agent {{ agent.name }}">
              Explore Agent
              <span class="agent-card__cta-arrow">
                <img src="/assets/images/explore.png" alt="" />
              </span>
            </button>
          </div>
        </article>
        }
      </section>
    </section>

    <!-- Pagination (pills style) -->
    <nav class="pager" aria-label="Pagination">
      <button class="pager-btn" (click)="prev()" [disabled]="!useCursor() && pageIndex() === 0"><span><img class="left" src="/assets/images/left.png"></span> Previous</button>
      @for (p of pagePills(); track p) {
      @if (p === '…') {
      <span class="pager-ellipsis">…</span>
      } @else {
      <button class="pager-page" (click)="gotoPage(p)" [class.active]="(+p) === (pageIndex() + 1)">
        {{ p }}
      </button>
      }
      }
      <button class="pager-btn" (click)="next()" [disabled]="!useCursor() && (pageIndex() + 1 >= totalPages())">Next <span><img src="/assets/images/right.png"></span></button>
      <span class="pager-size">
        Page size:
        <select [value]="pageSize()" (change)="changeSize($any($event.target).value)">
          <option>6</option>
          <option>12</option>
          <option>18</option>
          <option>24</option>
        </select>
      </span>
    </nav>

    <!-- Loading / Error -->
    @if (loading()) {
    <div style="padding: 1rem 2rem">Loading...</div>
    } @if (error()) {
    <div class="error" style="padding: 1rem 2rem; color: #b91c1c">{{ error() }}</div>
    }
    }
    <!-- Page footer -->
    <!-- Footer - Static Position -->
    <footer class="bg-cognizantDark text-white border-t border-gray-700">
      <div class="mx-auto px-8 py-4">
        <p class="text-sm">©2025 Cognizant, all rights reserved | Privacy Policy</p>
      </div>
    </footer>

    <!-- Full-page loading overlay (always present for fade in/out) -->
    <div class="loading-overlay black" [class.visible]="loading()" role="status" aria-live="polite"
      aria-busy="{{ loading() }}">
      <div class="loading-container" aria-label="Loading, please wait">
        <!-- CSS spinner (fallback & default) -->
        <div class="css-spinner" aria-hidden="false"></div>

        <!-- GIF (optional visual) -->
        <!-- /assets/images/loading.gif -->
        <!-- Optional text -->
        <p class="loading-text">Loading, please wait...</p>
      </div>
    </div>
  </main>
</div>
