<!-- agent-detail.component.html -->
<section class="detail-wrap">


  <!-- Hero strip below the global header (1920x200px => height: 12.5rem) -->
  <section class="agent-hero" aria-labelledby="agent-hero-title">
    <div class="agent-hero__inner">
      <!-- Left: Title + Stage -->
      <div class="agent-hero__left">
        <h1 id="agent-hero-title" class="agent-hero__title">
          {{ agent()?.name }}
        </h1>

        <div class="agent-hero__stage" aria-label="Stage">
          <img src="/assets/images/details/tag.png" />
          <span class="agent-hero__stage-label">Stage:</span>
          <span class="agent-hero__stage-value">{{ stageUi() }}</span>
        </div>
      </div>


      <!-- Right: badges with separators -->
      <div class="agent-hero__right flex" role="group" aria-label="Agent metadata">
        <!-- Industry -->
        <div class="hero-badge">
          <img src="/assets/images/details/industry.png" class="hero-badge__icon industry" />
          <span class="hero-badge__text">
            {{ agent()?.industry || 'Finance & Accounting' }}
          </span>
        </div>

        <span class="hero-sep" aria-hidden="true"></span>

        <!-- Agent Count (with see-through circle) -->
        <div class="hero-badge hero-badge--count">
          <div class="count-circle" aria-hidden="true">
            <span class="count-circle__num">
              {{ agent()?.agentCount ?? agent()?.agentNames?.length ?? 0 }}
            </span>
          </div>
          <span class="hero-badge__text count">Agent Count</span>
        </div>

        <span class="hero-sep" aria-hidden="true"></span>

        <!-- Technology -->
        <div class="hero-badge">
          <img src="/assets/images/details/technology.png" class="hero-badge__icon technology" />
          <span class="hero-badge__text">
            @for (t of techList(); track t; let last = $last) {
            {{ t }} @if (!last) { <span class="pipe" aria-hidden="true"> | </span> }
            }
          </span>
        </div>
      </div>

    </div>
  </section>



  <!-- Two-column layout like your screenshot -->

  <!-- ===== Below-hero content: Solution Overview (left) + Inline Video (right) ===== -->

  <section class="detail-content">
    <div class="detail-columns">
      <div class="detail-left">
        <h2 class="detail-heading">Solution Overview</h2>

        @if (agent()?.solutionOverview?.description) {
        <p class="detail-intro">{{ agent()?.solutionOverview?.description }}</p>
        }

        <ul class="detail-list">
          @for (p of (agent()?.solutionOverview?.points ?? []); track p.heading + p.description) {
          @if ((p.heading.trim() || p.description.trim())) {
          <li class="detail-item">
            <span class="detail-dot" aria-hidden="true"></span>
            <div class="detail-item-content">
              @if (p.heading.trim()) { <strong class="detail-item-title">{{ p.heading }}</strong> }
              @if (p.description.trim()) { <span class="detail-item-desc">{{ p.description }}</span> }
            </div>
          </li>
          }
          }
        </ul>
      </div>

      <div class="detail-right">
        <div class="video-card">
          @if (agent()?.videoUrl) {
          <video controls [src]="agent()?.videoUrl" preload="metadata"></video>

          } @else {
          <div class="video-card placeholder">
            <img src="/assets/images/details/video-ph.png" alt="No video available" />
          </div>
          }
        </div>
      </div>
    </div>
  </section>



  <!-- ===== Benefits band (titles only). Tooltip = description. ===== -->
  @if (agent()?.benefits?.points?.length) {
  <section class="benefits-band" aria-labelledby="benefits-title">
    <div class="benefits-band__inner">
      <h2 id="benefits-title" class="benefits-title">Benefits</h2>

      <ul class="benefits-list" role="list">
        @for (b of agent()?.benefits?.points ?? []; track b.heading) {
        <!-- Tooltip via title; also expose for a11y via aria-label -->
        <li class="benefit" [attr.title]="b.description" [attr.aria-label]="b.description">
          <span class="benefit-text">{{ b.heading }}</span>
        </li>
        }
      </ul>
    </div>
  </section>
  }

  <!-- ===== Resources & Contact Info row (below benefits) ===== -->
  <section class="resources-contact-row" aria-label="Resources & Contact">
    <!-- Resources block -->
    @if (agent()?.resources?.length) {
    <div class="resources-block">
      <h3 class="resources-heading">Resources</h3>


      <div class="resources-grid">
        @for (r of agent()?.resources ?? []; track r.url) {
        <div class="resource-card">
          <!-- If it's a video URL, show <video> -->
          @if (isVideoUrl(r.url)) {
          <div class="resource-thumb">
            <video controls [src]="r.url" preload="metadata"></video>
          </div>
          } @else {
          <!-- Otherwise, link opens in new tab and show appropriate placeholder -->
          <a class="resource-thumb" [href]="r.url" target="_blank" rel="noopener"
            aria-label="Open resource: {{ r.description }}">
            <img [src]="resourceThumb(r.url)" alt="{{ r.description }}" />
          </a>
          }

          <!-- Caption -->
          <p class="resource-caption">{{ r.description }}</p>
        </div>
        }
      </div>

    </div>
    }

    <!-- Contact block -->
    <aside class="contact-block">
      <h3 class="contact-heading">Contact Info</h3>

      <div class="contact-card">
        <img src="/assets/images/details/mail.png" />
        <div class="contact-text">
          <div class="contact-name">{{ agent()?.pocName }}</div>
          @if (agent()?.pocEmail) {
          <a class="contact-email" [href]="'mailto:' + agent()?.pocEmail">{{ agent()?.pocEmail }}</a>
          }
        </div>
      </div>
    </aside>

  </section>

  <!-- Simple modal for video preview -->
  <!-- <div class="preview-overlay" [class.visible]="previewOpen()">
    <div class="preview-dialog">
      <button class="close" (click)="closePreview()">×</button>
      <video controls [src]="previewUrl()" preload="metadata"></video>
    </div>
  </div> -->

  <!-- Loading / Error -->
  <!-- <div class="loading-overlay" [class.visible]="loading()">
    <div class="loading-container">
      <div class="css-spinner" aria-hidden="true"></div>
      <p class="loading-text">Loading, please wait…</p>
    </div>
  </div> -->

  @if (error()) {
  <div class="text-red-600 font-semibold text-center py-4">{{ error() }}</div>
  }